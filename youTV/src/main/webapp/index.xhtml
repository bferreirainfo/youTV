<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html
 	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
	<f:view contentType="text/html" locale="pt_BR">	
	<h:head>
	</h:head>
		<h:body>
			<h:form>
				<input id="queryInput" value="http://localhost:8080/template/js/" />
				<input id="term" />
				<p:commandButton type="button" onclick="procurarArquivos(getInputValue('queryInput'))"  /><br/>
				<textarea id="result" />
					 <div id="includedContent" style="display: none;" >
					 	
					 </div>
				<script>
					function getInputValue(inputId){
						return document.getElementById(inputId).value;
					}
					function procurarArquivos(url){
						carregarPaginaDestino(url);
					}
					function carregarPaginaDestino(url){
					      $("#includedContent").load(url,procurarLinks); 
					    };
					function procurarLinks(){
						$('a[href*=".js"]').each(function() {
							lerArquivo($(this).attr('href'));
						});
						
					}
					function lerArquivo(url){
						var txtFile = new XMLHttpRequest();
						txtFile.open("GET", url, true);
						txtFile.onreadystatechange = function() {
						  if (txtFile.readyState === 4) {  // Makes sure the document is ready to parse.
						    if (txtFile.status === 200) {  // Makes sure it's found the file.
						      allText = txtFile.responseText; 
						      lines = txtFile.responseText.split("\n"); // Will separate each line into an array
						      lines.forEach(function(entry,index) {
						    	  	column = entry.indexOf(getInputValue('term'));
						    	  	if(column > -1){
						    	  		getInputValue('result').value =(
						    	  				'Encontrei: Arquivo: '+ url + " linha: " +  index + "na coluna" + entry.indexOf(getInputValue('term'))
						    	  				);
						    	  		
						    	  	}
						    	});
						    }
						  }
						}
						txtFile.send(null);
					}
					
				</script>
			</h:form>
		</h:body>
	</f:view>
</html>
